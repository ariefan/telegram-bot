FROM node:20-alpine

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies (including drizzle-kit)
RUN npm install

# Copy necessary files for drizzle
COPY drizzle.config.ts ./
COPY src/db/schema ./src/db/schema
COPY tsconfig.json ./

# Expose drizzle studio port
EXPOSE 4983

# Run drizzle studio
CMD ["npx", "drizzle-kit", "studio", "--host", "0.0.0.0", "--port", "4983"]
